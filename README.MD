# ğŸš€ Python High-Performance Real-time Chat

![Python](https://img.shields.io/badge/Python-3.8%2B-3776AB?style=for-the-badge&logo=python&logoColor=white)
![WebSocket](https://img.shields.io/badge/WebSocket-Realtime-orange?style=for-the-badge&logo=html5)
![SQLite](https://img.shields.io/badge/SQLite-Database-003B57?style=for-the-badge&logo=sqlite&logoColor=white)
![Status](https://img.shields.io/badge/Status-Stable-green?style=for-the-badge)

Má»™t há»‡ thá»‘ng nháº¯n tin trá»±c tuyáº¿n thá»i gian thá»±c (Real-time Chat System) Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« con sá»‘ 0 (From Scratch) sá»­ dá»¥ng **Python Asyncio** vÃ  giao thá»©c **WebSocket**. Dá»± Ã¡n táº­p trung tá»‘i Æ°u hÃ³a Ä‘á»™ trá»… (Zero-latency), kháº£ nÄƒng chá»‹u táº£i cao vÃ  báº£o máº­t dá»¯ liá»‡u ngÆ°á»i dÃ¹ng. Trong quÃ¡ trÃ¬nh test local, há»‡ thá»‘ng hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh vá»›i hÃ ng chá»¥c káº¿t ná»‘i Ä‘á»“ng thá»i.

---

## ğŸ“‘ Má»¥c Lá»¥c

1. [Giá»›i thiá»‡u](#-giá»›i-thiá»‡u)
2. [TÃ­nh nÄƒng ná»•i báº­t](#-tÃ­nh-nÄƒng-ná»•i-báº­t)
3. [CÃ´ng nghá»‡ sá»­ dá»¥ng](#-cÃ´ng-nghá»‡-sá»­-dá»¥ng)
4. [Cáº¥u trÃºc dá»± Ã¡n](#-cáº¥u-trÃºc-dá»±-Ã¡n)
5. [CÃ i Ä‘áº·t & Váº­n hÃ nh](#-cÃ i-Ä‘áº·t--váº­n-hÃ nh)
6. [Kiáº¿n trÃºc há»‡ thá»‘ng (Technical Deep Dive)](#-kiáº¿n-trÃºc-há»‡-thá»‘ng)
7. [CÆ¡ sá»Ÿ dá»¯ liá»‡u (Schema)](#-cÆ¡-sá»Ÿ-dá»¯-liá»‡u)
8. [Kháº¯c phá»¥c sá»± cá»‘](#-kháº¯c-phá»¥c-sá»±-cá»‘)

---

## ğŸ“– Giá»›i thiá»‡u

Dá»± Ã¡n nÃ y lÃ  giáº£i phÃ¡p thay tháº¿ cho cÃ¡c á»©ng dá»¥ng chat truyá»n thá»‘ng sá»­ dá»¥ng HTTP polling (gÃ¢y cháº­m trá»…). Báº±ng cÃ¡ch duy trÃ¬ káº¿t ná»‘i hai chiá»u (Full-duplex) qua WebSocket, tin nháº¯n Ä‘Æ°á»£c truyá»n táº£i tá»©c thÃ¬ giá»¯a Client vÃ  Server.

Há»‡ thá»‘ng há»— trá»£ Ä‘áº§y Ä‘á»§ quy trÃ¬nh: **ÄÄƒng kÃ½ -> ÄÄƒng nháº­p -> Chá»n phÃ²ng -> Chat (Text/Image) -> LÆ°u trá»¯ lá»‹ch sá»­.**

---

## âœ¨ TÃ­nh nÄƒng ná»•i báº­t

* **âš¡  Low-Latency (Äá»™ trá»… ráº¥t tháº¥p, gáº§n thá»i gian thá»±c):** Ãp dá»¥ng kiáº¿n trÃºc Optimistic UI â€“ Server broadcast tin nháº¯n ngay khi nháº­n Ä‘Æ°á»£c, sau Ä‘Ã³ má»›i ghi vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u á»Ÿ luá»“ng báº¥t Ä‘á»“ng bá»™, giÃºp giáº£m cáº£m nháº­n Ä‘á»™ trá»… cá»§a ngÆ°á»i dÃ¹ng mÃ  khÃ´ng lÃ m giÃ¡n Ä‘oáº¡n luá»“ng xá»­ lÃ½ chÃ­nh cá»§a server.

* **ğŸ–¼ï¸ Gá»­i áº£nh tá»‘c Ä‘á»™ cao:** Há»— trá»£ mÃ£ hÃ³a Base64 Ä‘á»ƒ gá»­i vÃ  hiá»ƒn thá»‹ hÃ¬nh áº£nh trá»±c tiáº¿p trong khung chat.
* **ğŸ‘¥ Multi-Room (Äa phÃ²ng chat):**
    * PhÃ²ng Chung (General)
    * PhÃ²ng CÃ´ng Nghá»‡ (Tech)
    * PhÃ²ng Game
* **ğŸ” Báº£o máº­t lá»›p á»©ng dá»¥ng:**
    * Máº­t kháº©u ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c bÄƒm (Hashing) báº±ng thuáº­t toÃ¡n **SHA-256** (má»©c báº£o máº­t cÆ¡ báº£n, cÃ³ thá»ƒ nÃ¢ng cáº¥p báº±ng Salt/Bcrypt trong tÆ°Æ¡ng lai).
    * NgÄƒn cháº·n SQL Injection cÆ¡ báº£n thÃ´ng qua Parameterized Queries.
* **ğŸ’¾ Persist Data (LÆ°u trá»¯ vÄ©nh viá»…n):**
    * Tá»± Ä‘á»™ng lÆ°u tin nháº¯n vÃ o SQLite.
    * Tá»± Ä‘á»™ng táº£i láº¡i 50 tin nháº¯n gáº§n nháº¥t khi ngÆ°á»i dÃ¹ng vÃ o phÃ²ng.
* **ğŸ¨ Giao diá»‡n Responsive:** Hoáº¡t Ä‘á»™ng tá»‘t trÃªn cáº£ MÃ¡y tÃ­nh vÃ  trÃ¬nh duyá»‡t Äiá»‡n thoáº¡i.

---

## ğŸ›  CÃ´ng nghá»‡ sá»­ dá»¥ng

| ThÃ nh pháº§n | CÃ´ng nghá»‡ | Chi tiáº¿t |
| :--- | :--- | :--- |
| **Backend** | Python 3 | NgÃ´n ngá»¯ xá»­ lÃ½ chÃ­nh. |
| **Network** | `websockets` | ThÆ° viá»‡n xá»­ lÃ½ giao thá»©c WS/WSS. |
| **Concurrency** | `asyncio` | Xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ (Asynchronous I/O) Ä‘á»ƒ chá»‹u táº£i cao. |
| **Database** | SQLite3 | Há»‡ quáº£n trá»‹ CSDL quan há»‡ (nháº¹, khÃ´ng cáº§n server riÃªng). |
| **Security** | `hashlib` | ThÆ° viá»‡n mÃ£ hÃ³a máº­t kháº©u. |
| **Frontend** | HTML5 / CSS3 | Giao diá»‡n ngÆ°á»i dÃ¹ng. |
| **Scripting** | Vanilla JS | JavaScript thuáº§n, sá»­ dá»¥ng WebSocket API cá»§a trÃ¬nh duyá»‡t. |

---

## ğŸ“‚ Cáº¥u trÃºc dá»± Ã¡n

Äá»ƒ Ä‘áº£m báº£o há»‡ thá»‘ng váº­n hÃ nh chÃ­nh xÃ¡c, cáº¥u trÃºc thÆ° má»¥c Ä‘Æ°á»£c tá»• chá»©c nhÆ° sau:

```text
ChatApp/
â”‚
â”œâ”€â”€ âš™ï¸ BACKEND
â”‚   â”œâ”€â”€ server.py        # [Main] Server WebSocket, xá»­ lÃ½ logic luá»“ng tin nháº¯n.
â”‚   â”œâ”€â”€ db.py            # [Model] Module giao tiáº¿p vá»›i Database (CRUD User/Message).
â”‚   â””â”€â”€ chat.db          # [Data] File CSDL (Tá»± Ä‘á»™ng sinh ra khi cháº¡y server).
â”‚
â”œâ”€â”€ ğŸŒ FRONTEND
â”‚   â”œâ”€â”€ index.html       # Trang chá»§ (Landing Page).
â”‚   â”œâ”€â”€ register.html    # Trang Ä‘Äƒng kÃ½ tÃ i khoáº£n.
â”‚   â”œâ”€â”€ login.html       # Trang Ä‘Äƒng nháº­p.
â”‚   â””â”€â”€ chat.html        # Giao diá»‡n chat chÃ­nh (Logic JS client náº±m á»Ÿ Ä‘Ã¢y).
â”‚
â””â”€â”€ ğŸ“„ README.md        # TÃ i liá»‡u hÆ°á»›ng dáº«n chi tiáº¿t.

ğŸš€ CÃ i Ä‘áº·t & Váº­n hÃ nh
1. YÃªu cáº§u tiÃªn quyáº¿t
MÃ¡y tÃ­nh Ä‘Ã£ cÃ i Ä‘áº·t Python 3.7 trá»Ÿ lÃªn.

ÄÃ£ cÃ i Ä‘áº·t trÃ¬nh quáº£n lÃ½ gÃ³i pip.

2. CÃ i Ä‘áº·t thÆ° viá»‡n
Má»Ÿ Terminal (CMD/PowerShell/Terminal) táº¡i thÆ° má»¥c dá»± Ã¡n vÃ  cháº¡y:
pip install websockets

3. Khá»Ÿi cháº¡y Server
Cháº¡y lá»‡nh sau Ä‘á»ƒ báº­t mÃ¡y chá»§:
python server.py    
Dáº¥u hiá»‡u thÃ nh cÃ´ng: Terminal hiá»‡n dÃ²ng chá»¯: ğŸš€ SERVER ÄANG CHáº Y Táº I: ws://localhost:8765

4. Sá»­ dá»¥ng
- Truy cáº­p file index.html báº±ng trÃ¬nh duyá»‡t (Chrome/Edge/Firefox).
- Báº¥m nÃºt ÄÄƒng kÃ½ Ä‘á»ƒ táº¡o tÃ i khoáº£n.
- ÄÄƒng nháº­p vÃ  báº¯t Ä‘áº§u chat.
- Äá»ƒ test: Má»Ÿ thÃªm 1 tab áº©n danh (Incognito) hoáº·c trÃ¬nh duyá»‡t khÃ¡c, Ä‘Äƒng nháº­p nick khÃ¡c vÃ  chat qua láº¡i.

ğŸ§  Kiáº¿n trÃºc há»‡ thá»‘ng
Luá»“ng xá»­ lÃ½ tin nháº¯n (The "Non-blocking" Flow)
Há»‡ thá»‘ng Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ khÃ´ng bao giá» Ä‘á»ƒ ngÆ°á»i dÃ¹ng pháº£i chá» Ä‘á»£i (Blocking):

Client A gá»­i tin nháº¯n JSON {"type": "message", "content": "Hello"}.

Server nháº­n gÃ³i tin.

BÆ°á»›c 1 (Æ¯u tiÃªn): Server ngay láº­p tá»©c Broadcast (phÃ¡t tÃ¡n) tin nháº¯n tá»›i táº¥t cáº£ cÃ¡c Client B, C, D Ä‘ang káº¿t ná»‘i trong phÃ²ng. -> NgÆ°á»i dÃ¹ng tháº¥y tin nháº¯n ngay láº­p tá»©c.
BÆ°á»›c 2 (Háº­u xá»­ lÃ½): Server má»Ÿ má»™t luá»“ng riÃªng (asyncio.to_thread) Ä‘á»ƒ thá»±c hiá»‡n viá»‡c ghi tin nháº¯n vÃ o file chat.db (thao tÃ¡c I/O cháº­m cháº¡p).
Káº¿t quáº£: Server váº«n ráº£nh tay Ä‘á»ƒ nháº­n tin nháº¯n tiáº¿p theo trong khi á»• cá»©ng Ä‘ang ghi dá»¯ liá»‡u.

ğŸ—„ CÆ¡ sá»Ÿ dá»¯ liá»‡u (Schema)

Há»‡ thá»‘ng sá»­ dá»¥ng SQLite (chat.db) vá»›i 3 báº£ng chÃ­nh:

1ï¸âƒ£ Báº£ng users (LÆ°u tÃ i khoáº£n ngÆ°á»i dÃ¹ng)

| Cá»™t | Kiá»ƒu dá»¯ liá»‡u | MÃ´ táº£ |

| id | INTEGER (PK) | ID tá»± tÄƒng |
| username | TEXT   | TÃªn Ä‘Äƒng nháº­p (Duy nháº¥t) |
| password | TEXT   | Máº­t kháº©u Ä‘Ã£ mÃ£ hÃ³a (SHA-256) |
| role     | TEXT   | Quyá»n ngÆ°á»i dÃ¹ng (máº·c Ä‘á»‹nh: user) |
| created_at | DATETIME | Thá»i Ä‘iá»ƒm táº¡o tÃ i khoáº£n |

---

2ï¸âƒ£ Báº£ng messages (LÆ°u lá»‹ch sá»­ chat phÃ²ng chung)

| Cá»™t | Kiá»ƒu dá»¯ liá»‡u | MÃ´ táº£ |

| id  | INTEGER (PK) | ID tá»± tÄƒng |
| room |    TEXT     | ID phÃ²ng chat (general, tech, game) |
| sender |  TEXT     | TÃªn ngÆ°á»i gá»­i |
| message | TEXT     | Ná»™i dung tin nháº¯n |
| msg_type | TEXT    | Loáº¡i tin nháº¯n (text / image) |
| created_at | DATETIME | Thá»i gian gá»­i |

---

3ï¸âƒ£ Báº£ng private_messages (LÆ°u lá»‹ch sá»­ chat riÃªng)

| Cá»™t | Kiá»ƒu dá»¯ liá»‡u | MÃ´ táº£ |

| id  | INTEGER (PK) | ID tá»± tÄƒng |
| sender   | TEXT | NgÆ°á»i gá»­i |
| receiver | TEXT | NgÆ°á»i nháº­n |
| message  | TEXT | Ná»™i dung tin nháº¯n |
| created_at | DATETIME | Thá»i gian gá»­i |


ğŸ”§ Kháº¯c phá»¥c sá»± cá»‘
1. Lá»—i: "Connection Refused" hoáº·c khÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c
NguyÃªn nhÃ¢n: Báº¡n chÆ°a cháº¡y file server.py hoáº·c Ä‘Ã£ táº¯t cá»­a sá»• Terminal.
CÃ¡ch sá»­a: Má»Ÿ láº¡i Terminal vÃ  cháº¡y python server.py. Giá»¯ cá»­a sá»• Ä‘Ã³ luÃ´n má»Ÿ.

2. Chat trong máº¡ng LAN (Wifi) khÃ´ng Ä‘Æ°á»£c?
Máº·c Ä‘á»‹nh code Ä‘ang Ä‘á»ƒ ws://localhost:8765. localhost chá»‰ cháº¡y trÃªn mÃ¡y cá»§a báº¡n.

CÃ¡ch sá»­a:
- Má»Ÿ CMD, gÃµ ipconfig (Windows) hoáº·c ifconfig (Mac/Linux) Ä‘á»ƒ láº¥y Ä‘á»‹a chá»‰ IPv4 (VÃ­ dá»¥: 192.168.1.15).
- VÃ o cÃ¡c file .html, sá»­a dÃ²ng káº¿t ná»‘i thÃ nh: const ws = new WebSocket("ws://192.168.1.15:8765");
- Gá»­i file HTML cho cÃ¡c mÃ¡y khÃ¡c trong cÃ¹ng máº¡ng Wifi.

3. Gá»­i áº£nh bá»‹ lag/Ä‘Æ¡?
WebSocket gá»­i dá»¯ liá»‡u dáº¡ng Text. áº¢nh lá»›n (>2MB) khi chuyá»ƒn sang Base64 sáº½ thÃ nh chuá»—i text ráº¥t dÃ i (~3 triá»‡u kÃ½ tá»±), gÃ¢y ngháº½n máº¡ng táº¡m thá»i.
Khuyáº¿n nghá»‹: Chá»‰ nÃªn gá»­i áº£nh dÆ°á»›i 2MB hoáº·c áº£nh chá»¥p mÃ n hÃ¬nh.

ğŸ‘¨â€ğŸ’» TÃ¡c giáº£
Dá»± Ã¡n Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi NhÃ³m 13 Láº­p TrÃ¬nh Máº¡ng
